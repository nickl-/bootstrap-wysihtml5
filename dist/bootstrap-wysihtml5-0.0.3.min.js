!function(t,e){"use strict";var i={"font-styles":function(t,e){var i=e&&e.size?" btn-"+e.size:"";return"<li class='dropdown'><a class='btn dropdown-toggle"+i+"' data-toggle='dropdown' href='#'>"+"<span class='current-font'>"+t.font_styles.normal+"</span>&nbsp;<b class='caret'></b>"+"</a>"+"<ul class='dropdown-menu'>"+"<li><a data-wysihtml5-command='formatBlock' data-wysihtml5-command-value='div' tabindex='-1'>"+t.font_styles.normal+"</a></li>"+"<li><a data-wysihtml5-command='formatBlock' data-wysihtml5-command-value='h1' tabindex='-1'>"+t.font_styles.h1+"</a></li>"+"<li><a data-wysihtml5-command='formatBlock' data-wysihtml5-command-value='h2' tabindex='-1'>"+t.font_styles.h2+"</a></li>"+"<li><a data-wysihtml5-command='formatBlock' data-wysihtml5-command-value='h3' tabindex='-1'>"+t.font_styles.h3+"</a></li>"+"<li><a data-wysihtml5-command='formatBlock' data-wysihtml5-command-value='h4'>"+t.font_styles.h4+"</a></li>"+"<li><a data-wysihtml5-command='formatBlock' data-wysihtml5-command-value='h5'>"+t.font_styles.h5+"</a></li>"+"<li><a data-wysihtml5-command='formatBlock' data-wysihtml5-command-value='h6'>"+t.font_styles.h6+"</a></li>"+"</ul>"+"</li>"},emphasis:function(t,e){var i=e&&e.size?" btn-"+e.size:"";return"<li><div class='btn-group'><a class='btn"+i+"' data-wysihtml5-command='bold' title='CTRL+B' tabindex='-1'>"+t.emphasis.bold+"</a>"+"<a class='btn"+i+"' data-wysihtml5-command='italic' title='CTRL+I' tabindex='-1'>"+t.emphasis.italic+"</a>"+"<a class='btn"+i+"' data-wysihtml5-command='underline' title='CTRL+U' tabindex='-1'>"+t.emphasis.underline+"</a>"+"</div>"+"</li>"},lists:function(t,e){var i=e&&e.size?" btn-"+e.size:"";return"<li><div class='btn-group'><a class='btn"+i+"' data-wysihtml5-command='insertUnorderedList' title='"+t.lists.unordered+"' tabindex='-1'><i class='icon-list'></i></a>"+"<a class='btn"+i+"' data-wysihtml5-command='insertOrderedList' title='"+t.lists.ordered+"' tabindex='-1'><i class='icon-th-list'></i></a>"+"<a class='btn"+i+"' data-wysihtml5-command='Outdent' title='"+t.lists.outdent+"' tabindex='-1'><i class='icon-indent-left'></i></a>"+"<a class='btn"+i+"' data-wysihtml5-command='Indent' title='"+t.lists.indent+"' tabindex='-1'><i class='icon-indent-right'></i></a>"+"</div>"+"</li>"},link:function(t,e){var i=e&&e.size?" btn-"+e.size:"";return"<li><div class='bootstrap-wysihtml5-insert-link-modal modal hide fade'><div class='modal-header'><a class='close' data-dismiss='modal'>&times;</a><h3>"+t.link.insert+"</h3>"+"</div>"+"<div class='modal-body'>"+"<input value='http://' class='bootstrap-wysihtml5-insert-link-url input-xlarge'>"+"<label class='checkbox'> <input type='checkbox' class='bootstrap-wysihtml5-insert-link-target' checked>"+t.link.target+"</label>"+"</div>"+"<div class='modal-footer'>"+"<a href='#' class='btn' data-dismiss='modal'>"+t.link.cancel+"</a>"+"<a href='#' class='btn btn-primary' data-dismiss='modal'>"+t.link.insert+"</a>"+"</div>"+"</div>"+"<a class='btn"+i+"' data-wysihtml5-command='createLink' title='"+t.link.insert+"' tabindex='-1'><i class='icon-share'></i></a>"+"</li>"},image:function(t,e){var i=e&&e.size?" btn-"+e.size:"",a=e.fileUpload?"<input name='file' class='file-uploader' type='file' multiple><br />"+t.image.usage+"<p class='uploaded'>":"";return"<li><div class='bootstrap-wysihtml5-insert-image-modal modal hide fade'><div class='modal-header'><a class='close' data-dismiss='modal'>&times;</a><h3>"+t.image.insert+"</h3>"+"</div>"+"<div class='modal-body'>"+"<input value='http://' class='bootstrap-wysihtml5-insert-image-url input-xlarge'>"+"<br />"+a+"</div>"+"<div class='modal-footer'>"+"<a href='#' class='btn' data-dismiss='modal'>"+t.image.cancel+"</a>"+"<a href='#' class='btn btn-primary' data-dismiss='modal'>"+t.image.insert+"</a>"+"</div>"+"</div>"+"<a class='btn"+i+"' data-wysihtml5-command='insertImage' title='"+t.image.insert+"' tabindex='-1'><i class='icon-picture'></i></a>"+"</li>"},video:function(t){return"<li><div class='bootstrap-wysihtml5-insert-video-modal modal hide fade'><div class='modal-header'><a class='close' data-dismiss='modal'>&times;</a><h3>"+t.video.insert+"</h3>"+"</div>"+"<div class='modal-body'>"+"<div class='control-group'>"+"<input type='text' data-wysihtml5-dialog-field='src' value='http://' class='bootstrap-wysihtml5-insert-video-url input-xlarge'>"+"</div>"+"<div class='control-group error form-inline'>"+"<label class='video-error hide'>"+t.video.invalid+"</label>"+"</div>"+"</div>"+"<div class='modal-footer'>"+"<a href='#' class='btn' data-dismiss='modal' data-wysihtml5-dialog-action='cancel'>"+t.video.cancel+"</a>"+"<a href='#' class='btn btn-primary' data-dismiss='modal' data-wysihtml5-dialog-action='save'>"+t.video.insert+"</a>"+"</div>"+"</div>"+"<a class='btn' data-wysihtml5-command='insertVideo' title='"+t.video.insert+"'><i class='icon-film'></i></a>"+"</li>"},html:function(t,e){var i=e&&e.size?" btn-"+e.size:"";return"<li><div class='btn-group'><a class='btn"+i+"' data-wysihtml5-action='change_view' title='"+t.html.edit+"' tabindex='-1'><i class='icon-pencil'></i></a>"+"</div>"+"</li>"},"format-code":function(t,e){var i=e&&e.size?" btn-"+e.size:"";return"<li><div class='btn-group'><a class='btn "+i+"' data-wysihtml5-action='formatCode' title='"+t.formatCode.highlight+"'><i class='icon-list-alt'></i></a>"+"</div>"+"</li>"},speech:function(t,e){var i=e&&e.size?" btn-"+e.size:"";return"<li><div class='btn-group'><a class='btn "+i+"' data-wysihtml5-command='insertSpeech' title='"+t.speech.insert+"'><i class='iconic-mic'></i></a>"+"</div>"+"</li>"},color:function(t,e){var i=e&&e.size?" btn-"+e.size:"";return"<li class='dropdown'><a class='btn dropdown-toggle"+i+"' data-toggle='dropdown' href='#' tabindex='-1'>"+"<span class='icon-color'><img src='/assets/bootstrap-wysihtml5/lib/img/icon-color.png'></span>&nbsp;<b class='caret'></b>"+"</a>"+"<ul class='dropdown-menu'>"+"<li><div class='wysihtml5-colors current-color' data-wysihtml5-command-value='black'></div><a class='wysihtml5-colors-title' data-wysihtml5-command='foreColor' data-wysihtml5-command-value='black'>"+t.colours.black+"</a></li>"+"<li><div class='wysihtml5-colors' data-wysihtml5-command-value='silver'></div><a class='wysihtml5-colors-title' data-wysihtml5-command='foreColor' data-wysihtml5-command-value='silver'>"+t.colours.silver+"</a></li>"+"<li><div class='wysihtml5-colors' data-wysihtml5-command-value='gray'></div><a class='wysihtml5-colors-title' data-wysihtml5-command='foreColor' data-wysihtml5-command-value='gray'>"+t.colours.gray+"</a></li>"+"<li><div class='wysihtml5-colors' data-wysihtml5-command-value='maroon'></div><a class='wysihtml5-colors-title' data-wysihtml5-command='foreColor' data-wysihtml5-command-value='maroon'>"+t.colours.maroon+"</a></li>"+"<li><div class='wysihtml5-colors' data-wysihtml5-command-value='red'></div><a class='wysihtml5-colors-title' data-wysihtml5-command='foreColor' data-wysihtml5-command-value='red'>"+t.colours.red+"</a></li>"+"<li><div class='wysihtml5-colors' data-wysihtml5-command-value='purple'></div><a class='wysihtml5-colors-title' data-wysihtml5-command='foreColor' data-wysihtml5-command-value='purple'>"+t.colours.purple+"</a></li>"+"<li><div class='wysihtml5-colors' data-wysihtml5-command-value='green'></div><a class='wysihtml5-colors-title' data-wysihtml5-command='foreColor' data-wysihtml5-command-value='green'>"+t.colours.green+"</a></li>"+"<li><div class='wysihtml5-colors' data-wysihtml5-command-value='olive'></div><a class='wysihtml5-colors-title' data-wysihtml5-command='foreColor' data-wysihtml5-command-value='olive'>"+t.colours.olive+"</a></li>"+"<li><div class='wysihtml5-colors' data-wysihtml5-command-value='navy'></div><a class='wysihtml5-colors-title' data-wysihtml5-command='foreColor' data-wysihtml5-command-value='navy'>"+t.colours.navy+"</a></li>"+"<li><div class='wysihtml5-colors' data-wysihtml5-command-value='blue'></div><a class='wysihtml5-colors-title' data-wysihtml5-command='foreColor' data-wysihtml5-command-value='blue'>"+t.colours.blue+"</a></li>"+"<li><div class='wysihtml5-colors' data-wysihtml5-command-value='orange'></div><a class='wysihtml5-colors-title' data-wysihtml5-command='foreColor' data-wysihtml5-command-value='orange'>"+t.colours.orange+"</a></li>"+"</ul>"+"</li>"}},a=function(t,e,a){return i[t](e,a)},o=function(e,a){this.el=e;var o=a||l;for(var s in o.customTemplates)i[s]=o.customTemplates[s];this.toolbar=this.createToolbar(e,o),this.editor=this.createEditor(a),window.editor=this.editor,t("iframe.wysihtml5-sandbox").each(function(e,i){t(i.contentWindow).off("focus.wysihtml5").on({"focus.wysihtml5":function(){t("li.dropdown").removeClass("open")}})})};o.prototype={constructor:o,createEditor:function(i){i=i||{},i=t.extend(!0,{},i),i.toolbar=this.toolbar[0];var a=new e.Editor(this.el[0],i);if(i&&i.events)for(var o in i.events)a.on(o,i.events[o]);return a},createToolbar:function(e,i){var o=this,s=t("<ul/>",{"class":"wysihtml5-toolbar",style:"display:none"}),r=i.locale||l.locale||"en",d=i.fileUpload;for(var c in l){var m=!1;void 0!==i[c]?i[c]===!0&&(m=!0):m=l[c],m===!0&&(s.append(a(c,n[r],i)),"html"===c&&this.initHtml(s),"link"===c&&this.initInsertLink(s),"image"===c&&this.initInsertImage(s,d),"video"===c&&this.initInsertVideo(s),"format-code"==c&&this.initFormatCode(s))}if(i.toolbar)for(c in i.toolbar)s.append(i.toolbar[c]);return s.find("a[data-wysihtml5-command='formatBlock']").click(function(e){var i=e.target||e.srcElement,a=t(i);o.toolbar.find(".current-font").text(a.html())}),s.find("a[data-wysihtml5-command='foreColor']").click(function(e){var i=e.target||e.srcElement,a=t(i);o.toolbar.find(".current-color").removeClass("current-color"),a.addClass("current-color")}),this.el.before(s),s},initHtml:function(t){var e="a[data-wysihtml5-action='change_view']";t.find(e).click(function(){t.find("a.btn").not(e).toggleClass("disabled")})},initFormatCode:function(t){var e=this,i="a[data-wysihtml5-action='formatCode']";t.find(i).click(function(){e.editor.composer.commands.exec("formatCode")})},initInsertImage:function(e,i){var a,o=this,s=e.find(".bootstrap-wysihtml5-insert-image-modal"),l=s.find(".bootstrap-wysihtml5-insert-image-url"),n=s.find("a.btn-primary"),r=l.val(),d=[],c=function(t){o.editor.currentView.element.focus(),a&&(o.editor.composer.selection.setBookmark(a),a=null),o.editor.composer.commands.exec("insertImage",t)};l.keypress(function(t){13==t.which&&(c(),s.modal("hide"))}),n.click(function(){var e=l.val();l.val(r),d.push({src:e}),t.each(d,function(t,e){c(e)}),d=[],s.find(".uploaded").text("")}),s.on("shown",function(){l.focus()}),s.on("hide",function(){o.editor.currentView.element.focus()}),i&&s.find(".file-uploader").fileupload(t.extend({},i,{done:function(e,a){var o=i.done(e,a),l=s.find(".uploaded");t.isArray(o)||(o=[o]),d=d.concat(o),t.each(o,function(t,e){e=document.createTextNode(e.alt||e.src),l.append("<br />").append(e)})},dropzone:s})),e.find("a[data-wysihtml5-command=insertImage]").click(function(){var e=t(this).hasClass("wysihtml5-command-active");return e?!0:(o.editor.currentView.element.focus(!1),a=o.editor.composer.selection.getBookmark(),s.appendTo("body").modal("show"),s.on("click.dismiss.modal",'[data-dismiss="modal"]',function(t){t.stopPropagation()}),!1)})},initInsertVideo:function(t){var e=this,i=t.find(".bootstrap-wysihtml5-insert-video-modal"),a=i.find(".bootstrap-wysihtml5-insert-video-url"),o=i.find("a.btn-primary"),s=i.find(".video-error"),l=function(){s.hide();var t=a.val(),i=t;if("http://www.youtube.com/watch?v="!=t.substr(0,31))return s.show(),!1;var o=t.substr(31);i="http://www.youtube.com/embed/"+o.split("&")[0],a.val(t),e.editor.currentView.element.focus(),e.editor.composer.commands.exec("insertVideo",{src:i,width:"398",height:"224"})};a.keypress(function(t){13==t.which&&(l(),i.modal("hide"))}),o.click(l),i.on("shown",function(){a.focus()}),i.on("hide",function(){e.editor.currentView.element.focus()}),t.find("a[data-wysihtml5-command=insertVideo]").click(function(){return i.modal("show"),i.on("click.dismiss.modal",'[data-dismiss="modal"]',function(t){t.stopPropagation()}),!1})},initInsertLink:function(e){var i,a=this,o=e.find(".bootstrap-wysihtml5-insert-link-modal"),s=o.find(".bootstrap-wysihtml5-insert-link-url"),l=o.find(".bootstrap-wysihtml5-insert-link-target"),n=o.find("a.btn-primary"),r=s.val(),d=function(){var t=s.val();s.val(r),a.editor.currentView.element.focus(),i&&(a.editor.composer.selection.setBookmark(i),i=null);var e=l.prop("checked");a.editor.composer.commands.exec("createLink",{href:t,target:e?"_blank":"_self",rel:e?"nofollow":""})};s.keypress(function(t){13==t.which&&(d(),o.modal("hide"))}),n.click(d),o.on("shown",function(){s.focus()}),o.on("hide",function(){a.editor.currentView.element.focus()}),e.find("a[data-wysihtml5-command=createLink]").click(function(){var e=t(this).hasClass("wysihtml5-command-active");return e?!0:(a.editor.currentView.element.focus(!1),i=a.editor.composer.selection.getBookmark(),o.appendTo("body").modal("show"),o.on("click.dismiss.modal",'[data-dismiss="modal"]',function(t){t.stopPropagation()}),!1)})}};var s={resetDefaults:function(){t.fn.wysihtml5.defaultOptions=t.extend(!0,{},t.fn.wysihtml5.defaultOptionsCache)},bypassDefaults:function(e){return this.each(function(){var i=t(this);i.data("wysihtml5",new o(i,e))})},shallowExtend:function(e){var i=t.extend({},t.fn.wysihtml5.defaultOptions,e||{},t(this).data()),a=this;return s.bypassDefaults.apply(a,[i])},deepExtend:function(e){var i=t.extend(!0,{},t.fn.wysihtml5.defaultOptions,e||{}),a=this;return s.bypassDefaults.apply(a,[i])},init:function(t){var e=this;return s.shallowExtend.apply(e,[t])}};t.fn.wysihtml5=function(e){return s[e]?s[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?(t.error("Method "+e+" does not exist on jQuery.wysihtml5"),void 0):s.init.apply(this,arguments)},t.fn.wysihtml5.Constructor=o;var l=t.fn.wysihtml5.defaultOptions={"font-styles":!0,color:!0,emphasis:!0,lists:!0,html:!0,link:!0,image:!0,video:!0,"format-code":!0,speech:!0,events:{},parserRules:{classes:{"wysiwyg-color-silver":1,"wysiwyg-color-gray":1,"wysiwyg-color-white":1,"wysiwyg-color-maroon":1,"wysiwyg-color-red":1,"wysiwyg-color-purple":1,"wysiwyg-color-fuchsia":1,"wysiwyg-color-green":1,"wysiwyg-color-lime":1,"wysiwyg-color-olive":1,"wysiwyg-color-yellow":1,"wysiwyg-color-navy":1,"wysiwyg-color-blue":1,"wysiwyg-color-teal":1,"wysiwyg-color-aqua":1,"wysiwyg-color-orange":1},tags:{b:{},i:{},br:{},ol:{},ul:{},li:{},h1:{},h2:{},h3:{},h4:{},h5:{},h6:{},blockquote:{},u:1,img:{check_attributes:{width:"numbers",alt:"alt",src:"url",height:"numbers"}},a:{check_attributes:{href:"url",target:"alt",rel:"alt"}},iframe:{check_attributes:{src:"url",width:"numbers",height:"numbers"},set_attributes:{frameborder:"0"}},span:1,div:1,code:1,pre:1}},stylesheets:["/assets/bootstrap-wysihtml5/lib/css/wysiwyg-color.css"],locale:"en"};"undefined"==typeof t.fn.wysihtml5.defaultOptionsCache&&(t.fn.wysihtml5.defaultOptionsCache=t.extend(!0,{},t.fn.wysihtml5.defaultOptions));var n=t.fn.wysihtml5.locale={en:{font_styles:{normal:"Normal text",h1:"Heading 1",h2:"Heading 2",h3:"Heading 3",h4:"Heading 4",h5:"Heading 5",h6:"Heading 6"},emphasis:{bold:'<i class="icon-bold"></i>',italic:'<i class="icon-italic"></i>',underline:'<i class="icon-underline"></i>'},lists:{unordered:"Unordered list",ordered:"Ordered list",outdent:"Outdent",indent:"Indent"},link:{insert:"Insert link",cancel:"Cancel",target:"Open link in new window"},image:{insert:"Insert image",cancel:"Cancel",usage:"Enter URL, drag & drop here, or select from your computer"},video:{insert:"Insert YouTube Video",cancel:"Cancel",invalid:"invalid video URL"},html:{edit:"Edit HTML"},colours:{black:"Black",silver:"Silver",gray:"Grey",maroon:"Maroon",red:"Red",purple:"Purple",green:"Green",olive:"Olive",navy:"Navy",blue:"Blue",orange:"Orange"},formatCode:{highlight:"Highlight Code"},speech:{insert:"Insert Speech recognition."}}}}(window.jQuery,window.wysihtml5),function(t){var e="IFRAME";t.commands.insertVideo={exec:function(i,a,o){o="object"==typeof o?o:{src:o};var s,l,n=i.doc,r=this.state(i);if(r)return i.selection.setBefore(r),l=r.parentNode,l.removeChild(r),t.dom.removeEmptyTextNodes(l),"A"!==l.nodeName||l.firstChild||(i.selection.setAfter(l),l.parentNode.removeChild(l)),t.quirks.redraw(i.element),void 0;r=n.createElement(e);for(s in o)r[s]=o[s];console.log(r),i.selection.insertNode(r),t.browser.hasProblemsSettingCaretAfterImg()?(textNode=n.createTextNode(t.INVISIBLE_SPACE),i.selection.insertNode(textNode),i.selection.setAfter(textNode)):i.selection.setAfter(r)},state:function(i){var a,o,s,l=i.doc;return t.dom.hasElementWithTagName(l,e)?(a=i.selection.getSelectedNode(l))?a.nodeName===e?a:a.nodeType!==t.ELEMENT_NODE?!1:(o=i.selection.getText(l),(o=t.lang.string(o).trim())?!1:(s=i.selection.getNodes(l,t.ELEMENT_NODE,function(t){return"IFRAME"===t.nodeName}),1!==s.length?!1:s[0])):!1:!1},value:function(t){var e=this.state(t);return e&&e.src}}}(wysihtml5),function(t){t.commands.insertEmbedVideo={exec:function(e,i,a){var o=a.src,s={src:t.commands.getAttributeValue.exec(o,"src"),width:t.commands.getAttributeValue.exec(o,"width"),height:t.commands.getAttributeValue.exec(o,"height")},l=Object.create?Object.create(s):new Object(s);t.commands.insertVideo.exec(e,i,l)},state:function(e){t.commands.insertVideo.state(e)},value:function(e){t.commands.insertVideo.value(e)}}}(wysihtml5),function(t){t.commands.getAttributeValue={exec:function(t,e){return t.substring(parseInt(t.indexOf(e))+e.length+2,t.length).split('" ')[0]}}}(wysihtml5),function(t){t.commands.formatCode={exec:function(e){var i=this.state(e);if(i)e.selection.executeAndRestore(function(){var e=i.querySelector("code");t.dom.replaceWithChildNodes(i),e&&(t.dom.replaceWithChildNodes(i),hljs.highlightBlock(e))});else{var a=e.selection.getRange();if(!a)return!1;var o=a.extractContents(),s=e.doc.createElement("pre"),l=e.doc.createElement("code");s.appendChild(l),l.appendChild(o),a.insertNode(s),hljs.highlightBlock(l),e.selection.selectNode(s)}},state:function(e){var i=e.selection.getSelectedNode();return t.dom.getParentElement(i,{nodeName:"CODE"})&&t.dom.getParentElement(i,{nodeName:"PRE"})}}}(wysihtml5);